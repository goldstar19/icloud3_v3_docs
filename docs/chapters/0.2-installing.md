# Installing and Configuring iCloud3

------

## Installation Steps

There are several steps you need to do to begin using iCloud3 to track your devices. They are:

1. Install iCloud3 from HACS or manually.
2. Install and configure the HA Companion App (iOS App).
3. Set up the Event Log Lovelace card component.
4. Set up the iCloud3 integrations component (iCloud3 Configurator). Then open it to set up your Apple iCloud account and devices you want to track. 
5. Add your Apple iCloud account credentitials and authenticate access to your account.
6. Add at least one device you want to track. When setting it up the first time:
   - Set up only your device (iPhone) until you are familiar with how iCloud3 operates.
   - Verify the device_tracker entity and the sensors for your iPhone are created.
7. Set up the Lovelace card that displays your devices sensors and the Event Log.

These steps are described below.



------

### Install iCloud3

- **Easy Way** -  Use HACS
  1. Open HACS.
  2. Select **Integrations**
  3. Type **iCloud3** in the Search Bar at the top of the screen. 
  4. Select **iCloud3 Device Tracker**
  5. Select **Download**, then select **Download** again in the popup window.
  6. Restart Home Assistant.
  7. After Home Assistant restarts, set up the iCloud3 Integration described below.
- **Hard Way** - Manual Installation
  1. Download the *icloud3.zip* file from the *https://github.com/gcobb321/icloud3* iCloud3 GitHub Repository.
  2. Unzip the file into the *config/sustom_components/icloud3* directory.
  3. Restart Home Assistant.
  4. After Home Assistant restarts, set up the iCloud3 Integration described below.




### Install the iOS App on your iPhone or iPad



### Set up the Event Log Lovelace Card

The Event Log is a custom Lovelace card. When iCloud3 starts the first time, it copies the Event Log custom card file (**icloud3-event-log-card.js*) to the *config/www/icloud3* directory. Every time iCloud3 starts, it checks to see if the latest version is installed and, if not, copies the new version and displays a notice that the browser's cache needs to be cleared (see below) before it can be used. 

> The default directory for the Event Log Card is the *config/www/icloud3* directory. You can change it to another location (e.g.: *www/community/icloud3*) on the *iCloud3 Configurator > Menu Page 2 > Other Parameters* screen. 

**Updating the Lovelace Resource** - The Event Log Cards needs to be added to the Lovelace Resources list before it can be used on a Lovelace screen.

1. Select **Settings > Dashboards > â‹® > Resources**

2. Select **+ Add Resource**

3. The Add Resources window opens, type the following:

4. ```
   URL: 
   /local/icloud3/icloud3-event-log-card.js
   
   RESOURCE TYPE: 
   JavaScript Module
   ```

5. Select **Create**

> *Note: Using another custom card directory* - If you move the Event Log card to another directory, be sure to update the Lovelace Resource parameter. Change the directory (*icloud3*) in the URL statement in step 4 to the new directory name and select the directory name you are using in the *Event Log Directory* field on the *iCloud3 Configurator > Menu Page 2 > Other Parameters*  screen.

**Clearing the Browser's Cache** - The browser (Chrome, Edge, Safari) stores the Home Assistant screens in it's cache. This needs to be cleared to load a new version of the Event Log card. Do this as follows;

1. Press **Ctrl-Shift-Delete**.
2. Select **Cached Images and Files**, the select **Clear Data**
3. Return to the Lovelace screen and click the **Refresh Icon**. 

**Clearing the Home Assistant Companion (iOS App) Cache** - The cache also needs to be cleared on each of the devices (iPhones, iPads) running the Home Assistant Companion app. 

1. In the *Home Assistant Companion App*, tap **Settings > Companion App.**
2. Tap **Debugging > Reset front end cache**
3. Tap **Settings > Done**.
4. Redisplay one of the Lovelace screens and pull it down to reload the screens.



### Set up the iCloud3 Integration

iCloud3 is a Home Assistant Integration and is configured on the Integrations screens.

1. Select **HA Settings > Devices & Services > Integrations**.
2. Select **+ Add Integration** in the lower-right hand corner.
3. Type **iCloud3**. Then select **iCloud3** from the list of Integrations.
4. Follow the instructions on the screen.



### Configure iCloud3

iCloud3 needs to be configured with the devices you want to track and and monitor. To open the *Configurator*:

1. Select **HA Settings > Devices & Services > Integrations**
2. Select **iCloud3 > Configure** 

 Although nine screens are used to configure all of the iCloud3 parameters, only two need to be set up for iCloud3 to start tracking devices. They are:

- **iCloud Account & Location Data Source**

  - Specify the source of your location data - iCloud Location Servers, the iOS App or both. 

  - Enter your iCloud Account username and password.

- **iCloud Devices**
  - Add the devices you want to track or monitor. This includes assigning a device_tracker entity id to the device, specifying the *friendly name*, selecting the source of the specific location data (Family Sharing List, FindMy App, iOS App) and setting up other parameters for the device. 
- **The Other Configuration Screens**
  - Review the other screens just to see what is configurable. Nothing has to be done right now to get you up and running. The default values will work fine. 

iCloud3 will restart once you are done adding the devices. They will be tracked and you are on your way/

> ! *Chapter 3, Using iCloud3 Configurator* explains each of the configuration screens, the various options you can select and how they can be used.[](../images/auth-process.jpg)

 

### Set up an iCloud3 screen

The layout of the raw yaml code for the *iCloud Custom Component* and *Event Log* screen is shown in the *Sample Screens, Automations and Scripts* chapter.

1. Copy the raw yaml code for the screen you want to use to get you going.
2. Create and/or edit the Lovelace screen as you do with any screen layout.
3. Create a new card for the iCloud3 entities.
4. Go into the yaml editor, copy the yaml code from the sample screens.
5. Change the entity names to the names you have assigned to your devices.



